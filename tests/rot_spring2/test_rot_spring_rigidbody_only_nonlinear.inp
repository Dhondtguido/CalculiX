** ------------------------------------------------------------
** Minimal nonlinear rotational spring test (NO beam elements)
** Piecewise M-θ about Z on ROT-node DOF 3.
** ------------------------------------------------------------

*HEADING
Rigid-body rotational spring (nonlinear)

*NODE
11, 0.0, 0.0, 0.0
12, 0.0, 1.0, 0.0
13, 0.0, 0.0, 1.0
21, 1.0, 0.0, 0.0
22, 1.0, 1.0, 0.0
23, 1.0, 0.0, 1.0
101, 0.0, 0.0, 0.0
102, 0.0, 0.0, 0.0
201, 1.0, 0.0, 0.0
202, 1.0, 0.0, 0.0

*NSET, NSET=RB_LEFT
11,12,13
*NSET, NSET=RB_RIGHT
21,22,23

*NSET, NSET=REF_LEFT
101
*NSET, NSET=REF_RIGHT
201
*NSET, NSET=ROT_LEFT
102
*NSET, NSET=ROT_RIGHT
202

*RIGID BODY, NSET=RB_LEFT,  REF NODE=101, ROT NODE=102
*RIGID BODY, NSET=RB_RIGHT, REF NODE=201, ROT NODE=202

*ELEMENT, TYPE=SPRING2, ELSET=E_RS
1, 102, 202

** Nonlinear M-θ (theta [rad], moment [N*m])
*SPRING, ELSET=E_RS, NONLINEAR
3, 3
0.0,    0.0
0.001,  1.0
0.010,  1.1

*BOUNDARY
REF_LEFT,  1, 3, 0.
REF_RIGHT, 1, 3, 0.
ROT_LEFT,  1, 3, 0.
ROT_RIGHT, 1, 2, 0.

*STEP
*STATIC
*CLOAD
ROT_RIGHT, 3, 1.05

*NODE PRINT, NSET=ROT_RIGHT
U

*END STEP
